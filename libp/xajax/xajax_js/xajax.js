function Xajax(){this.DebugMessage=function(e){e.length>1e3&&(e=e.substr(0,1e3)+"...\n[long response]\n...");try{(void 0==this.debugWindow||1==this.debugWindow.closed)&&(this.debugWindow=window.open("about:blank","xajax-debug","width=800,height=600,scrollbars=1,resizable,status"),this.debugWindow.document.write('<html><head><title>Xajax debug output</title></head><body><h2>Xajax debug output</h2><div id="debugTag"></div></body></html>')),e=e.replace(/&/g,"&amp;"),e=e.replace(/</g,"&lt;"),e=e.replace(/>/g,"&gt;"),debugTag=this.debugWindow.document.getElementById("debugTag"),debugTag.innerHTML="<b>"+(new Date).toString()+"</b>: "+e+"<hr/>"+debugTag.innerHTML}catch(t){alert("Xajax Debug:\n "+e)}},this.workId="xajaxWork"+(new Date).getTime(),this.depth=0,this.responseErrorsForAlert=["400","401","402","403","404","500","501","502","503"],this.getRequestObject=function(){xajaxDebug&&this.DebugMessage("Initializing Request Object..");var e=null;if("undefined"!=typeof XMLHttpRequest&&(e=new XMLHttpRequest),!e&&"undefined"!=typeof ActiveXObject)try{e=new ActiveXObject("Msxml2.XMLHTTP")}catch(t){try{e=new ActiveXObject("Microsoft.XMLHTTP")}catch(a){try{e=new ActiveXObject("Msxml2.XMLHTTP.4.0")}catch(n){e=null}}}return!e&&window.createRequest&&(e=window.createRequest()),e||this.DebugMessage("Request Object Instantiation failed."),e},this.$=function(e){if(!e)return null;var t=document.getElementById(e);return!t&&document.all&&(t=document.all[e]),xajaxDebug&&!t&&e!=this.workId&&this.DebugMessage('Element with the id "'+e+'" not found.'),t},this.include=function(e){var t=document.getElementsByTagName("head"),a=document.createElement("script");a.type="text/javascript",a.src=e,t[0].appendChild(a)},this.stripOnPrefix=function(e){return e=e.toLowerCase(),0==e.indexOf("on")&&(e=e.replace(/on/,"")),e},this.addOnPrefix=function(e){return e=e.toLowerCase(),0!=e.indexOf("on")&&(e="on"+e),e},this.addHandler=function(sElementId,sEvent,sFunctionName){window.addEventListener?(sEvent=this.stripOnPrefix(sEvent),eval("this.$('"+sElementId+"').addEventListener('"+sEvent+"',"+sFunctionName+",false);")):(sAltEvent=this.addOnPrefix(sEvent),eval("this.$('"+sElementId+"').attachEvent('"+sAltEvent+"',"+sFunctionName+",false);"))},this.removeHandler=function(sElementId,sEvent,sFunctionName){window.addEventListener?(sEvent=this.stripOnPrefix(sEvent),eval("this.$('"+sElementId+"').removeEventListener('"+sEvent+"',"+sFunctionName+",false);")):(sAltEvent=this.addOnPrefix(sEvent),eval("this.$('"+sElementId+"').detachEvent('"+sAltEvent+"',"+sFunctionName+",false);"))},this.create=function(e,t,a){var n=this.$(e);objElement=document.createElement(t),objElement.setAttribute("id",a),n&&n.appendChild(objElement)},this.insert=function(e,t,a){var n=this.$(e);objElement=document.createElement(t),objElement.setAttribute("id",a),n.parentNode.insertBefore(objElement,n)},this.insertAfter=function(e,t,a){var n=this.$(e);objElement=document.createElement(t),objElement.setAttribute("id",a),n.parentNode.insertBefore(objElement,n.nextSibling)},this.getInput=function(e,t,a){var n;return window.addEventListener?(n=document.createElement("input"),n.setAttribute("type",e),n.setAttribute("name",t),n.setAttribute("id",a)):n=document.createElement('<input type="'+e+'" id="'+a+'" name="'+t+'">'),n},this.createInput=function(e,t,a,n){var i=this.$(e),d=this.getInput(t,a,n);i&&d&&i.appendChild(d)},this.insertInput=function(e,t,a,n){var i=this.$(e),d=this.getInput(t,a,n);d&&i&&i.parentNode&&i.parentNode.insertBefore(d,i)},this.insertInputAfter=function(e,t,a,n){var i=this.$(e),d=this.getInput(t,a,n);d&&i&&i.parentNode&&i.parentNode.insertBefore(d,i.nextSibling)},this.remove=function(e){objElement=this.$(e),objElement&&objElement.parentNode&&objElement.parentNode.removeChild&&objElement.parentNode.removeChild(objElement)},this.replace=function(sId,sAttribute,sSearch,sReplace){var bFunction=!1;if("innerHTML"==sAttribute&&(sSearch=this.getBrowserHTML(sSearch)),eval("var txt=this.$('"+sId+"')."+sAttribute),"function"==typeof txt&&(txt=txt.toString(),bFunction=!0),txt.indexOf(sSearch)>-1){for(var newTxt="";txt.indexOf(sSearch)>-1;)x=txt.indexOf(sSearch)+sSearch.length+1,newTxt+=txt.substr(0,x).replace(sSearch,sReplace),txt=txt.substr(x,txt.length-x);newTxt+=txt,bFunction?eval('this.$("'+sId+'").'+sAttribute+"=newTxt;"):this.willChange(sId,sAttribute,newTxt)&&eval('this.$("'+sId+'").'+sAttribute+"=newTxt;")}},this.getFormValues=function(e){var t,a=!1;arguments.length>1&&1==arguments[1]&&(a=!0);var n="";arguments.length>2&&(n=arguments[2]),t="string"==typeof e?this.$(e):e;var i="<xjxquery><q>";if(t&&"FORM"==t.tagName)for(var d=t.elements,s=0;s<d.length;s++)if(d[s].name&&d[s].name.substring(0,n.length)==n&&!(d[s].type&&("radio"==d[s].type||"checkbox"==d[s].type)&&0==d[s].checked||d[s].disabled&&1==d[s].disabled&&0==a)){var r=d[s].name;if(r)if("<xjxquery><q>"!=i&&(i+="&"),"select-multiple"==d[s].type)for(var o=0;o<d[s].length;o++)1==d[s].options[o].selected&&(i+=r+"="+encodeURIComponent(d[s].options[o].value)+"&");else i+=r+"="+encodeURIComponent(d[s].value)}return i+="</q></xjxquery>"},this.objectToXML=function(e){var t="<xjxobj>";for(i in e)try{if("constructor"==i)continue;if(e[i]&&"function"==typeof e[i])continue;var a=i,n=e[i];n&&"object"==typeof n&&this.depth<=50&&(this.depth++,n=this.objectToXML(n),this.depth--),t+="<e><k>"+a+"</k><v>"+n+"</v></e>"}catch(d){xajaxDebug&&this.DebugMessage(d.name+": "+d.message)}return t+="</xjxobj>"},this._nodeToObject=function(e){if("#cdata-section"==e.nodeName){for(var t="",a=0;a<e.parentNode.childNodes.length;a++)t+=e.parentNode.childNodes[a].data;return t}if("xjxobj"==e.nodeName){for(var t=new Array,a=0;a<e.childNodes.length;a++){var n,i,d=e.childNodes[a];if("e"==d.nodeName){for(var s=0;s<d.childNodes.length;s++)"k"==d.childNodes[s].nodeName?n=d.childNodes[s].firstChild.data:"v"==d.childNodes[s].nodeName&&(i=this._nodeToObject(d.childNodes[s].firstChild));null!=n&&null!=i&&(t[n]=i,n=i=null)}}return t}},this.loadingFunction=function(){},this.doneLoadingFunction=function(){};var loadingTimeout;this.call=function(e,t,a){var n,i,d;if(document.body&&xajaxWaitCursor&&(document.body.style.cursor="wait"),1==xajaxStatusMessages&&(window.status="Sending Request..."),clearTimeout(loadingTimeout),loadingTimeout=setTimeout("xajax.loadingFunction();",400),xajaxDebug&&this.DebugMessage("Starting xajax..."),null==a)var s=xajaxDefinedPost;else var s=a;var r,o=xajaxRequestUri;switch(s){case xajaxDefinedGet:var l=-1==o.indexOf("?")?"?xajax="+encodeURIComponent(e):"&xajax="+encodeURIComponent(e);if(t)for(n=0;n<t.length;n++)r=t[n],"object"==typeof r&&(r=this.objectToXML(r)),l+="&xajaxargs[]="+encodeURIComponent(r);l+="&xajaxr="+(new Date).getTime(),o+=l,d=null;break;case xajaxDefinedPost:if(d="xajax="+encodeURIComponent(e),d+="&xajaxr="+(new Date).getTime(),t)for(n=0;n<t.length;n++)r=t[n],"object"==typeof r&&(r=this.objectToXML(r)),d=d+"&xajaxargs[]="+encodeURIComponent(r);break;default:return alert("Illegal request type: "+s),!1}if(i=this.getRequestObject(),!i)return!1;if(i.open(s==xajaxDefinedGet?"GET":"POST",o,!0),s==xajaxDefinedPost)try{i.setRequestHeader("Method","POST "+o+" HTTP/1.1"),i.setRequestHeader("Content-Type","application/x-www-form-urlencoded")}catch(c){return alert("Your browser does not appear to  support asynchronous requests using POST."),!1}return i.onreadystatechange=function(){if(4==i.readyState){if(200==i.status)if(xajaxDebug&&xajax.DebugMessage("Received:\n"+i.responseText),i.responseXML&&i.responseXML.documentElement)xajax.processResponse(i.responseXML);else{var e="Error: the XML response that was returned from the server is invalid.";e+="\nReceived:\n"+i.responseText,trimmedResponseText=i.responseText.replace(/^\s+/g,""),trimmedResponseText=trimmedResponseText.replace(/\s+$/g,""),trimmedResponseText!=i.responseText&&(e+="\nYou have whitespace in your response."),alert(e),document.body.style.cursor="default",1==xajaxStatusMessages&&(window.status="Invalid XML response error")}else{if(xajax.responseErrorsForAlert.containsValue(i.status)){var e="Error: the server returned the following HTTP status: "+i.status;e+="\nReceived:\n"+i.responseText,alert(e)}document.body.style.cursor="default",1==xajaxStatusMessages&&(window.status="Invalid XML response error")}delete i,i=null}},xajaxDebug&&this.DebugMessage("Calling "+e+" uri="+o+" (post:"+d+")"),i.send(d),1==xajaxStatusMessages&&(window.status="Waiting for data..."),delete i,!0},this.getBrowserHTML=function(e){tmpXajax=this.$(this.workId),tmpXajax||(tmpXajax=document.createElement("div"),tmpXajax.setAttribute("id",this.workId),tmpXajax.style.display="none",tmpXajax.style.visibility="hidden",document.body.appendChild(tmpXajax)),tmpXajax.innerHTML=e;var t=tmpXajax.innerHTML;return tmpXajax.innerHTML="",t},this.willChange=function(element,attribute,newData){if(!document.body)return!0;if("innerHTML"==attribute&&(newData=this.getBrowserHTML(newData)),elementObject=this.$(element),elementObject){var oldData;if(eval("oldData=this.$('"+element+"')."+attribute),newData!==oldData)return!0}return!1},this.viewSource=function(){return"<html>"+document.getElementsByTagName("HTML")[0].innerHTML+"</html>"},this.processResponse=function(xml){clearTimeout(loadingTimeout),this.doneLoadingFunction(),1==xajaxStatusMessages&&(window.status="Processing...");var tmpXajax=null;if(xml=xml.documentElement,null!=xml){for(var skipCommands=0,i=0;i<xml.childNodes.length;i++)if(skipCommands>0)skipCommands--;else if("cmd"==xml.childNodes[i].nodeName){for(var cmd,id,property,data,search,type,before,objElement=null,j=0;j<xml.childNodes[i].attributes.length;j++)"n"==xml.childNodes[i].attributes[j].name?cmd=xml.childNodes[i].attributes[j].value:"t"==xml.childNodes[i].attributes[j].name?id=xml.childNodes[i].attributes[j].value:"p"==xml.childNodes[i].attributes[j].name?property=xml.childNodes[i].attributes[j].value:"c"==xml.childNodes[i].attributes[j].name&&(type=xml.childNodes[i].attributes[j].value);if(xml.childNodes[i].childNodes.length>1&&"#cdata-section"==xml.childNodes[i].firstChild.nodeName){data="";for(var j=0;j<xml.childNodes[i].childNodes.length;j++)data+=xml.childNodes[i].childNodes[j].data}else if(xml.childNodes[i].firstChild&&"xjxobj"==xml.childNodes[i].firstChild.nodeName)data=this._nodeToObject(xml.childNodes[i].firstChild),objElement="XJX_SKIP";else if(xml.childNodes[i].childNodes.length>1)for(var j=0;j<xml.childNodes[i].childNodes.length;j++){if(xml.childNodes[i].childNodes[j].childNodes.length>1&&"#cdata-section"==xml.childNodes[i].childNodes[j].firstChild.nodeName)for(var internalData="",k=0;k<xml.childNodes[i].childNodes[j].childNodes.length;k++)internalData+=xml.childNodes[i].childNodes[j].childNodes[k].nodeValue;else var internalData=xml.childNodes[i].childNodes[j].firstChild.nodeValue;"s"==xml.childNodes[i].childNodes[j].nodeName&&(search=internalData),"r"==xml.childNodes[i].childNodes[j].nodeName&&(data=internalData)}else data=xml.childNodes[i].firstChild?xml.childNodes[i].firstChild.nodeValue:"";"XJX_SKIP"!=objElement&&(objElement=this.$(id));var cmdFullname;try{if("cc"==cmd){cmdFullname="addConfirmCommands";var confirmResult=confirm(data);confirmResult||(skipCommands=id)}if("al"==cmd)cmdFullname="addAlert",alert(data);else if("js"==cmd)cmdFullname="addScript/addRedirect",eval(data);else if("jc"==cmd){cmdFullname="addScriptCall";var scr=id+"(";if(null!=data[0]){scr+="data[0]";for(var l=1;l<data.length;l++)scr+=",data["+l+"]"}scr+=");",eval(scr)}else"in"==cmd?(cmdFullname="addIncludeScript",this.include(data)):"as"==cmd?(cmdFullname="addAssign/addClear",this.willChange(id,property,data)&&eval("objElement."+property+"=data;")):"ap"==cmd?(cmdFullname="addAppend",eval("objElement."+property+"+=data;")):"pp"==cmd?(cmdFullname="addPrepend",eval("objElement."+property+"=data+objElement."+property)):"rp"==cmd?(cmdFullname="addReplace",this.replace(id,property,search,data)):"rm"==cmd?(cmdFullname="addRemove",this.remove(id)):"ce"==cmd?(cmdFullname="addCreate",this.create(id,data,property)):"ie"==cmd?(cmdFullname="addInsert",this.insert(id,data,property)):"ia"==cmd?(cmdFullname="addInsertAfter",this.insertAfter(id,data,property)):"ci"==cmd?(cmdFullname="addCreateInput",this.createInput(id,type,data,property)):"ii"==cmd?(cmdFullname="addInsertInput",this.insertInput(id,type,data,property)):"iia"==cmd?(cmdFullname="addInsertInputAfter",this.insertInputAfter(id,type,data,property)):"ev"==cmd?(cmdFullname="addEvent",property=this.addOnPrefix(property),eval("this.$('"+id+"')."+property+"= function(){"+data+";}")):"ah"==cmd?(cmdFullname="addHandler",this.addHandler(id,property,data)):"rh"==cmd&&(cmdFullname="addRemoveHandler",this.removeHandler(id,property,data))}catch(e){xajaxDebug&&alert("While trying to '"+cmdFullname+"' (command number "+i+"), the following error occured:\n"+e.name+": "+e.message+"\n"+(id&&!objElement?"Object with id='"+id+"' wasn't found.\n":""))}delete objElement,delete cmd,delete cmdFullname,delete id,delete property,delete search,delete data,delete type,delete before,delete internalData,delete j,delete k}delete xml,delete i,document.body.style.cursor="default",1==xajaxStatusMessages&&(window.status="Done")}}}Array.prototype.containsValue=function(e){for(var t=0;t<this.length;t++)if(this[t]==e)return!0;return!1};var xajax=new Xajax;xajaxLoaded=!0;